services:
    _defaults:
        autowire: true
        autoconfigure: true
        
    vs_payment_payment:
        class: Vankosoft\PaymentBundle\Component\Payment\Payment
    
    Vankosoft\PaymentBundle\Form\PaymentForm:
        tags: ['form.type']
        arguments:
            - '%vs_payment.model.payment_method.class%'
    
    vs_payment.order_factory:
        class: Vankosoft\PaymentBundle\Component\OrderFactory
        arguments:
            - '@security.token_storage'
            - '@request_stack'
            - '@doctrine'
            - '@vs_payment.repository.order'
            - '@vs_payment.factory.order'
            
#     vs_payment.subscription_factory:
#         class: Vankosoft\PaymentBundle\Component\Subscription\SubscriptionFactory
#         arguments:
#             - '@security.token_storage'
#             - '@vs_payment_payment'
#             - '@vs_payment.repository.pricing_plan_subscription'
#             - '@vs_payment.factory.pricing_plan_subscription'
    
    vs_payment.pricing_plan_subscriptions_subscriber:
        class: Vankosoft\PaymentBundle\EventSubscriber\PricingPlanSubscriptionsSubscriber
        arguments:
            - '@security.token_storage'
            - '@doctrine'
            - '@vs_payment.repository.pricing_plan_subscription'
            - '@vs_payment.factory.pricing_plan_subscription'
            - '@vs_payment.order_factory'
            - '@vs_payment.stripe_api'
        tags: [kernel.event_subscriber]
    
    ########################################################################
    # Checkout Controllers
    ########################################################################
    Vankosoft\PaymentBundle\Controller\Checkout\:
        resource: '../../../Controller/Checkout'
        tags: ['controller.service_arguments']
        autowire: true

    Vankosoft\PaymentBundle\Controller\Checkout\CreditCardController:
        tags: ['controller.service_arguments']
        autowire: false
        arguments:
            - '@doctrine'
            - '@vs_payment.repository.order'
        calls:
            - [ setContainer, [ '@service_container' ] ]
            
    ########################################################################
    # Shopping Cart Controllers
    ########################################################################
    Vankosoft\PaymentBundle\Controller\ShoppingCart\:
        resource: '../../../Controller/ShoppingCart'
        tags: ['controller.service_arguments']
        autowire: true
    
    Vankosoft\PaymentBundle\Controller\ShoppingCart\ShoppingCartController:
        tags: ['controller.service_arguments']
        autowire: false
        arguments:
            - '@doctrine'
            - '@vs_users.security_bridge'
            - '@vs_payment.factory.order'
            - '@vs_payment.repository.order'
            - '@vs_payment.factory.order_item'
            - '@vs_payment.repository.order_item'
            - '@vs_payment.repository.product'
            - '@vs_payment.order_factory'
        calls:
            - [ setContainer, [ '@service_container' ] ]
            
    Vankosoft\PaymentBundle\Controller\ShoppingCart\ShoppingCartCheckoutController:
        tags: ['controller.service_arguments']
        autowire: false
        arguments:
            - '@doctrine'
            - '@vs_payment.repository.order'
            - '@vs_payment_payment'
        calls:
            - [ setContainer, [ '@service_container' ] ]

    ########################################################################
    # Pricing Plans Controllers
    ########################################################################
    Vankosoft\PaymentBundle\Controller\PricingPlans\:
        resource: '../../../Controller/PricingPlans'
        tags: ['controller.service_arguments']
        autowire: true
    
    Vankosoft\PaymentBundle\Controller\PricingPlans\PricingPlanCheckoutController:
        tags: ['controller.service_arguments']
        autowire: false
        arguments:
            - '@doctrine'
            - '@event_dispatcher'
            - '@vs_users.security_bridge'
            - '@vs_payment.factory.order'
            - '@vs_payment.repository.order'
            - '@vs_payment.factory.order_item'
            - '@vs_payment.repository.pricing_plan_category'
            - '@vs_payment.repository.pricing_plan'
            - '@vs_payment.repository.payment_method'
            - '@vs_payment.repository.pricing_plan_subscription'
            - '@vs_payment_payment'
            - '@vs_payment.order_factory'
            - '@vs_payment.repository.gateway_config'
        calls:
            - [ setContainer, [ '@service_container' ] ]
